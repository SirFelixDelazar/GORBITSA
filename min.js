const normalize=e=>e.replace(/(\n|\s|\t|\v|\r)/g," ").replace(/\s\s+/g," ").trim(),checkStatement=e=>!!e.match(/^[GORBITSAgorbitsa][0-9]?[0-9]?[0-9]?$/),validate=e=>e.split(" ").every(checkStatement),toByteCode=e=>(e.charCodeAt(0)<<8)+(""!==e.slice(1,4)?+e.slice(1,4)%256:0),compile=e=>e.split(" ").map(toByteCode),evalStatement=(e,t,r,a,n)=>{const c=[...a],o=r+1,l=255&e;switch(String.fromCharCode(e>>8)){case"G":return[a[l],o,c];case"O":return c[l]=t,[t,o,c];case"R":return[+prompt("X")%256,o,c];case"B":return[t,0==t?l:o,c];case"I":return[(t+l)%256,o,c];case"T":return n.alert&&alert(n.ascii?String.fromCharCode(t):t+" "),document.getElementById("out").value+=n.ascii?String.fromCharCode(t):t+" ",[t,o,c];case"S":return[l,o,c];case"A":return[(t+a[l])%256,o,c];case"g":return[a[a[l]],o,c];case"o":return c[a[l]]=t,[t,o,c];case"r":return c[l]=+prompt("X")%256,[t,o,c];case"b":return[t,0==t?a[l]:o,c];case"i":return c[l]=(a[l]+t)%256,[t,o,c];case"t":return n.alert&&alert(n.ascii?String.fromCharCode(a[l]):a[l]+" "),document.getElementById("out").value+=n.ascii?String.fromCharCode(a[l]):a[l]+" ",[t,o,c];case"s":return[t^a[l],o,c];case"a":return[(t+a[a[l]])%256,o,c];default:return[-1,o,c]}},run=(e,t)=>{let r=new Array(255).fill(0),a=0,n=0,c=0;for(;[a,n,r]=evalStatement(e[n],a,n,r,t),-1!=a&&256!=n;)if(++c%1e3==0&&confirm(`Break? (Step:${c})`)){console.log(n,a,r);break}},main=()=>{const e=normalize(document.getElementById("in").value),t={ascii:document.getElementById("aout").checked,alert:document.getElementById("eale").checked};if(document.getElementById("out").value="",validate(e)){const r=compile(e);run(r,t)}};